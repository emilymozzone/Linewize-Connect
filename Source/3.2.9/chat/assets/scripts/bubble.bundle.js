(()=>{"use strict";var e,t,n,a,o,i,s,l,c,d,r,_,h,p,g,u,m,C,f,y,v,w,I,b,x,E,T,R,S,A,F;!function(e){e.FcmMessagesCacheId="lw_updater_fcm_messages_cache_id",e.GeneralCacheId="lw_updater_general_cache_id",e.RegistrationCacheId="lw_updater_registration_cache"}(e||(e={})),function(e){e.DmsDataCacheId="lw_dms_data_cache",e.DmsManagerConfigCacheId="lw_dms_manager_config_cache",e.CheckInDeviceInterval="lw_dms_check_in",e.RetryDMSRegTimeout="lw_retry_dms_registration_timeout",e[e.CheckInDeviceElapsed_ms=3e5]="CheckInDeviceElapsed_ms"}(t||(t={})),function(e){e[e.WalledGardenBasedInterval=3e4]="WalledGardenBasedInterval",e[e.DefaultPollingInterval=3e5]="DefaultPollingInterval"}(n||(n={})),function(e){e.KeepAliveCacheId="lw_keep_alive_cache_id"}(a||(a={})),function(e){e.ContentAware="ca"}(o||(o={})),function(e){e.HandleVerdictQueueInterval="lw_handle_verdict_queue_interval",e.EvictOldResponsesInterval="lw_evict_old_responses",e.VerdictRawResponseCacheId="lw_verdict_raw_response_cache",e.FallbackVerdictsCacheId="lw_fallback_verdicts_cache",e.VerdictResponseTimeCacheId="verdict_response_time_cache",e.VerdictYoutubeQueryCacheId="verdict_youtube_query_cache",e.VerdictClientFallback="client_fallback",e.CustomHeaderCacheId="lw_custom_header_cache",e.CustomHeaderCacheCleanIntervalId="lw_custom_header_cache_interval_id",e[e.CustomHeaderCacheCleanInterval=3e5]="CustomHeaderCacheCleanInterval",e[e.CustomHeaderCacheExpireTime=36e5]="CustomHeaderCacheExpireTime"}(i||(i={})),function(e){e.PurgeOldVerdictEntries="purge_old_verdict_entries"}(s||(s={})),function(e){e.EvictOldResponsesInterval="lw_evict_old_responses",e.VerdictResponseCacheId="lw_verdict_response_cache"}(l||(l={})),function(e){e.ConfigurationCacheId="lw_configuration_cache",e[e.ConfigLoadTimeout_ms=1e4]="ConfigLoadTimeout_ms",e[e.ConfigFetchInitialInterval=1e3]="ConfigFetchInitialInterval",e[e.ConfigFetchMaxInterval=3e4]="ConfigFetchMaxInterval",e[e.ConfigFetchMaxElapsedTime=9e4]="ConfigFetchMaxElapsedTime",e[e.ConfigFetchRandomizationFactor=.1]="ConfigFetchRandomizationFactor",e[e.ConfigFetchMultiplier=3]="ConfigFetchMultiplier"}(c||(c={})),function(e){e.ChatDataCacheId="lw_chat_data_cache",e.OpenChatTimeout="lw_open_chat_timeout"}(d||(d={})),function(e){e.ClassConfigRefreshTimeout="lw_class_config_refresh"}(r||(r={})),function(e){e.FocusLockCheckTimeout="lw_tabs_focuslock_check",e.ScreenshotUploadInterval="lw_screenshot_upload_interval",e.TabsDataCacheId="lw_tabs_data_cache"}(_||(_={})),function(e){e.PeriodicLoginInterval="lw_periodic_login",e.WhoamiLoginInterval="lw_whoami_login",e.FzboxPollInterval="lw_fzbox_poll",e.PeriodicLogsUploadInterval="lw_periodic_logs_upload_interval",e.MainDataCacheId="lw_main_data_cache",e.DevDataCacheId="lw_dev_data_cache",e.LoadingConfiKey="lw_loading_config_key",e.ConfigUpdateBackoffRetryStateKey="lw_config_update_backoff_retry_state_key",e.RemainingUpdatesKey="lw_remaining_updates_key",e.DevBuildReloadedKey="lw_dev_build_reloaded_key",e[e.ResourceLimitThresholdCheckInterval=72e5]="ResourceLimitThresholdCheckInterval"}(h||(h={})),function(e){e.CacheId="lw_companion_cache",e[e.MaxReconnectionAttempts=5]="MaxReconnectionAttempts",e[e.DeltaTimeout=5e3]="DeltaTimeout",e[e.MaxRetryRegistrationInterval_ms=3e4]="MaxRetryRegistrationInterval_ms"}(p||(p={})),function(e){e.CacheId="lw_system_config_cache"}(g||(g={})),function(e){e.CacheId="lw_delegation_config_cache",e.DelegationChangeScheduleId="lw_delegation_change_schedule_id"}(u||(u={})),function(e){e.ALL="all",e.BLOCKED="blocked",e.NONE="none"}(m||(m={})),function(e){e.CacheId="lw_content_aware_config_cache"}(C||(C={})),function(e){e.login="LOGIN",e.logout="LOGOUT",e.isLoggedIn="IS_LOGGED_IN",e.resetConfig="RESET-CONFIG",e.UpdateDynamicConfig="UPDATE-CONFIG-ALL"}(f||(f={})),function(e){e.active="ACTIVE",e.suspended="SUSPENDED"}(y||(y={})),function(e){e.PartialFailedCacheId="lw_partial_failed_cache",e.AuthenticationData="lw_authentication_data_cache",e.AuthTokenKey="auth_token"}(v||(v={})),function(e){e.ConnectionsCacheId="lw_connections_cache",e.ConnectionsUploadInterval="lw_Connections_upload_interval",e.TabsCacheId="lw_tabs_cache",e.UploadInfoCacheId="lw_upload_info_cache",e.mainFrameRequestType="main_frame",e.eventTypeSendHeaders="sendHeaders",e.eventTypeBeforeRequest="beforeRequest",e.eventTypeHeadersReceived="headersReceived",e.eventTypeCompleted="completed"}(w||(w={})),function(e){e.LastScreenshotCacheId="last_screenshot_cache"}(I||(I={})),function(e){e.SchedulesDataCacheId="lw_schedule_manager_data_cache_id"}(b||(b={})),function(e){e.ConfigUpdate="config_update_with_delay",e.ConfigUpdateBackoffRetry="config_update_backoff_retry",e.CaptureTabAndSend="capture_tab_and_send",e.SendRuntimeMessage="send_runtime_message",e.PrintBlockedMessage="print_blocked_message",e.CreateNewChromeTab="create_new_chrome_tab"}(x||(x={})),function(e){e.CONFIG_UPDATE="CONFIG_UPDATE",e.OPEN_TAB="OPEN_TAB",e.CLOSE_TAB="CLOSE_TAB",e.MESSAGE="MESSAGE",e.CLASS_STARTED="CLASS_STARTED",e.POLICY_UPDATE="POLICY_UPDATE",e.INIT_P2P="INIT_P2P"}(E||(E={})),function(e){e.Error="logging__error",e.Warning="logging__warning",e.Message="logging__message",e.Debug="logging__debug"}(T||(T={})),function(e){e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e.DEBUG="DEBUG"}(R||(R={})),function(e){e.InitOffscreenDocument="init_offscreen_socument_message",e.RegisterExtension="register_extension_with_native_agent",e.UnregisterExtension="unregister_extension_from_native_agent",e.RegisterClasswizeEventFail="register_extension_with_native_agent_classwize_events_fail",e.RegisterClasswizeEventMessage="register_extension_with_native_agent_classwize_events_Message",e.IsExtensionRegistered="is_extension_registered_with_native_agent",e.CompanionMessage="message_from_native_agent",e.CompanionErrorMessage="error_message_from_native_agent",e.RecoverCompanionStream="recover_companion_stream",e.RetryRegistration="retry_registration_with_native_agent",e.IpAddressChangeRoutine="ip_address_change_routine",e.TabsActivated="tabs_activated_message",e.UrlUpdatedInTab="url_updated_in_tab",e.P2PInitSignaler="p2p_init_signaler_message",e.P2PSetCloseTimeouts="p2p_set_close_timeouts_message",e.P2PGetScreenshot="p2p_get_screenshot_message",e.P2PGetTabs="p2p_get_tabs_message",e.UtilLocalIpUpdated="util_local_ip_updated_message",e.UtilResizeAndCompressImage="util_resize_and_compress_image",e.BroadcastWakeUpCall="cachescheduler_broadcast_wakeup_call",e.BroadcastScheduleTime="schedule-time-ee236fce-1426-4975-9d56-2ce4e8becd02",e.ChatBubbleStatus="chat_status",e.ChatInfo="chat_info",e.ChatGetLastMessage="last_chat_message",e.ChatClearLastMessage="clear_last_chat_message",e.UIGetStatus="ui_get_status",e.UIReloadConfig="ui_reload_config",e.UISendLogs="ui_send_logs",e.UserOverride="user_override",e.UpdaterNewMessage="updater_new_message",e.GetSafeguardVerdict="get_safe_guard_verdict",e.RedirectWebPage="redirect_web_page",e.EventMessage="event_service_message",e.InitAutoAuth="init_auto_auth",e.GetAuthCookie="get_auth_cookie",e.GetAuthToken="get_auth_token",e.UploadLogData="upload_log_data",e.UpdateOffscreenConfig="update_offscreen_config",e.MainConfigUpdated="main_config_updated",e.OffScreenLogMessage="Off_screen_log_message",e.GetManifestInfo="get_manifest_info",e.Token="TOKEN",e.ChatConfigUpdate="CHAT_CONFIG_UPDATE",e.UpdateTotalUnreadCount="UPDATE_TOTAL_UNREAD_COUNT",e.OpenChatClassroom="OPEN_CHAT_CLASSROOM",e.GoogleAuthenticate="GOOGLE_AUTHENTICATE",e.NativeTokenAuthenticate="NATIVE_TOKEN_AUTHENTICATE",e.GetBrowserType="get_browser_type",e.GetBrowserDetails="get_browser_details",e.CheckIfDomainIsBlocked="check_if_domain_is_blocked",e.ExtractFallbackDomains="extract_fallback_domains",e.LogMessage="log_message",e.InitOffscreenOpenTelemetry="init-offscreen-opentelemetry",e.SentryGetUserDetails="sentry-get-user-details",e.ChatLogMessage="chat-log-message",e.ReloadPopUp="reload-popup",e.PopupIsReloading="popup-is-reloading",e.PopupIsNotReloading="popup-is-not-reloading"}(S||(S={})),function(e){e.companion="companion",e.companionLite="companion_lite",e.proxyFilter="proxy_filter",e.dns_filter="dns_filter",e.classroom="classroom",e.liteModeEnabled="companion-mode-lite-enabled"}(A||(A={})),function(e){e.chrome="chrome",e.edge="edge"}(F||(F={}));var D=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function s(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}c((a=a.apply(e,t||[])).next())}))};class P{static init(){return D(this,void 0,void 0,(function*(){(yield P.sendRuntimeMessage({type:S.ChatBubbleStatus}))?(this.createChatBubble(),chrome.storage.sync.get(["haveShownFakePendo1"],(e=>{(null==e?void 0:e.haveShownFakePendo1)?this.removeChatPendo():(window.lwChatShowChatPendo=!0,this.createChatPendo())}))):(this.removeChatBubble(),this.removeChatPendo())}))}static sendRuntimeMessage(e){return D(this,void 0,void 0,(function*(){return new Promise((t=>{chrome.runtime.sendMessage(e,(e=>{t(e)}))}))}))}static removeChatPendo(){window.lwChatShowChatPendo=!1;const e=document.getElementById("pendoChatContainer");e&&e.remove()}static createChatBubble(){let e=document.getElementById("bubbleId");if(e){let t=document.getElementById("msgCountId");t||(t=document.createElement("div"),t.id="msgCountId",t.style.height="24px",t.style.width="24px",t.style.borderRadius="50%",t.style.backgroundColor="#DF2935",t.style.position="absolute",t.style.zIndex=String(Number.MAX_SAFE_INTEGER),t.style.top="-6.67%",t.style.left="66.67%",t.style.alignItems="center",t.style.justifyContent="center",t.style.display="flex",t.style.color="white",t.style.fontSize="12px",t.style.fontWeight="bold",e.appendChild(t)),window.lwChatMsgCount?(t.innerText=window.lwChatMsgCount>9?"9+":window.lwChatMsgCount.toString(),t.style.visibility="visible"):t.style.visibility="hidden",window.lwChatImageLeft&&(e.style.left=window.lwChatImageLeft+"px"),window.lwChatImageTop&&(e.style.top=window.lwChatImageTop+"px")}else{let t=0,n=0,a=0,o=0,i=!1;e=document.createElement("div"),e.id="bubbleId",e.style.height="60px",e.style.width="60px",e.style.position="fixed",e.style.right=String(0),e.style.bottom=String(0),e.style.zIndex=String(Number.MAX_SAFE_INTEGER-1);const s=document.createElement("img");s.style.width="60px",s.style.height="60px",s.style.borderRadius="50%",s.style.boxShadow="0 10px 20px 5px rgba(0, 0, 0, 0.1)",s.src=chrome.runtime.getURL("/chat/assets/imgs/bubble.svg"),e.appendChild(s),e.addEventListener("click",(()=>{window.lwChatShowChatPendo||(i?i=!1:P.sendRuntimeMessage({type:"SHOW_CHAT_UI"}))})),(s=>{e.onmousedown=e=>{(e=e||window.event).preventDefault(),a=e.clientX,o=e.clientY,document.onmouseup=c,document.onmousemove=l};const l=e=>{if(window.lwChatShowChatPendo)return;(e=e||window.event).preventDefault(),t=a-e.clientX,n=o-e.clientY,a=e.clientX,o=e.clientY;const l=s.offsetTop-n,c=s.offsetLeft-t;l<0||l+60>window.innerHeight||c<0||c+60>window.innerWidth||(s.style.top=l+"px",s.style.left=c+"px",i=!0)};function c(){document.onmouseup=null,document.onmousemove=null,P.sendRuntimeMessage({type:"UPDATE_CHAT_BUBBLE_POSITION",imageLeft:e.offsetLeft-n,imageTop:e.offsetTop-n})}})(e),document.body.appendChild(e)}}static removeChatBubble(){P.sendRuntimeMessage({type:"CLOSE_CHAT_UI"});const e=document.getElementById("bubbleId");if(e)return e.parentNode.removeChild(e)}static createChatPendo(){let e=document.getElementById("pendoChatContainer");if(!e){e=document.createElement("div"),e.style.all="revert",e.style.zIndex=String(Number.MAX_SAFE_INTEGER-1),e.id="pendoChatContainer",e.style.position="fixed",e.style.bottom="70px",e.style.right="8px",e.style.width="330px",e.style.height="406px",e.style.padding="32px 40px",e.style.background="#FFFFFF",e.style.borderRadius="3px",e.style.boxShadow="0px 4px 4px rgba(0, 0, 0, 0.25)",e.style.textAlign="center";const t=document.createElement("div");t.id="pendoChatWrapper",t.style.all="revert",t.style.position="relative",t.style.height="380px",t.style.width="330px";const n=document.createElement("div");n.style.all="revert",n.id="pendoChatHeader",n.style.display="flex";const a=function(){e.remove(),chrome.storage.sync.set({haveShownFakePendo1:!0}),P.sendRuntimeMessage({type:"CLOSE_FAKE_PENDO"})},o=document.createElement("img");o.style.all="revert",o.id="pendoChatClose",o.style.marginLeft="auto",o.style.height="12px",o.style.width="12px",o.style.cursor="pointer",o.addEventListener("click",a),o.src=chrome.runtime.getURL("/chat/assets/imgs/closePendo.svg"),n.appendChild(o),t.append(n);const i=document.createElement("div");i.style.all="revert",i.id="pendoChatContents",i.style.height="405px";const s=document.createElement("div");s.style.all="revert",s.style.textAlign="center",s.style.height="24px",s.style.width="330px";const l=document.createElement("img");l.style.all="revert",l.id="pendoChatBeta",l.src=chrome.runtime.getURL("/chat/assets/imgs/beta.svg"),s.appendChild(l),i.appendChild(s);const c=document.createElement("div");c.style.all="revert",c.id="pendoChatSubtitle",c.innerText="Your school has turned on teacher chat",c.style.lineHeight="30px",c.style.fontFamily="Roboto, Open Sans",c.style.fontWeight="500",c.style.fontSize="24px",c.style.textAlign="center",c.style.color="#000000",i.appendChild(c);const d=document.createElement("div");d.style.all="revert",d.id="pendoChatDescription",d.style.lineHeight="22px",d.style.fontSize="14px",d.style.textAlign="center",d.style.fontFamily="Roboto, Open Sans",d.style.width="336px",d.innerText="Click the chat button to directly message your teacher.",i.appendChild(d),i.style.all="revert",i.style.color="#000000";const r=document.createElement("img");r.style.all="revert",r.src=chrome.runtime.getURL("/chat/assets/imgs/pendo.png"),r.id="pendoChatImage",r.style.height="181px",r.style.width="336px",r.style.padding="16px 0",r.style.width="100%",r.style.objectFit="cover",i.appendChild(r);const _=document.createElement("div");_.style.all="revert",_.id="pendoChatLinks",_.style.height="18px",_.style.width="330px",_.style.fontSize="12px",_.style.display="flex",_.style.justifyContent="space-between";const h=document.createElement("a");h.style.all="revert",h.style.lineHeight="22px",h.style.margin="0 10px",h.style.color="#0075DB",h.style.fontWeight="bold",h.style.fontFamily="Roboto, Open Sans",h.style.fontSize="14px",h.href="https://dyzz9obi78pm5.cloudfront.net/app/image/id/60ffc732498ccce8297b23c8/n/cw-chat-students-using-classwize-chat.pdf",h.target="_blank",h.style.textDecoration="none",h.innerText="Learn more (Students)";const p=document.createElement("a");p.style.all="revert",p.innerText="Learn more (Parents)",p.style.lineHeight="22px",p.style.margin="0 10px",p.style.color="#0075DB",p.style.fontWeight="bold",p.style.fontFamily="Roboto, Open Sans",p.style.fontSize="14px",p.href="https://dyzz9obi78pm5.cloudfront.net/app/image/id/60ffc735a3abd3de297b23c6/n/cw-chat-parents-faq.pdf",p.target="_blank",p.style.textDecoration="none",_.appendChild(h),_.appendChild(p),i.appendChild(_);const g=document.createElement("div");g.style.all="revert";const u=document.createElement("button");u.style.all="revert",u.id="pendoChatDismissButton",u.style.marginTop="16px",u.innerText="SEND A MESSAGE",u.style.background="#0075DB",u.style.borderRadius="5px",u.style.color="#FFFFFF",u.style.border="0px",u.style.height="50px",u.style.width="330px",u.addEventListener("click",a),g.appendChild(u),i.appendChild(g),t.appendChild(i);const m=document.createElement("div");m.style.all="revert",m.style.height="15px",m.style.width="15px",m.style.transform="rotate(45deg)",m.style.backgroundColor="#FFFFFF",m.style.boxShadow="10px 0 8px -8px rgb(0 0 0 / 25%)",m.style.position="absolute",m.style.bottom="-8px",m.style.right="16px",e.appendChild(t),e.appendChild(m),document.body.appendChild(e),P.sendRuntimeMessage({type:"SHOW_FAKE_PENDO_1"})}}}P.init()})();